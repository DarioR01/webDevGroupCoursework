import{e as p,o as r,b as a,a as e,t as n,f as d,k as _,g as c,v as u,F as w,h as f,j as m}from"./index.27c418c6.js";const b={class:"container"},y={class:"card mb-3"},g={class:"row g-0"},v={class:"col-md-4"},k=["src"],q={class:"col-md-8"},S={class:"card-body"},$={class:"card-title"},C={class:"card-text"},T={class:"display-6"},P=["min"],U={for:"bid"},V=e("br",null,null,-1),j=e("button",{type:"submit",class:"btn btn-primary btn-lg"},"Bid",-1),B=e("h2",null,"Questions",-1),F={class:"list-group mb-1"},N={class:"list-group-item d-flex justify-content-between align-items-start"},O={class:"ms-2 me-auto"},A={class:"fw-bold"},Q={key:0},Y={key:1},E=["onSubmit"],H={class:"d-flex align-items-center"},I={class:"form-floating mb-3"},J=["id","onUpdate:modelValue"],R=e("label",{for:"answerQuestion"},"Click to Answer the question",-1),X=e("div",null,[e("button",{type:"submit",class:"btn btn-primary"},"Answer")],-1),D={class:"form-floating"},M=e("label",{for:"askQuestion"},"Click to ask a question",-1),G=e("br",null,null,-1),L=e("button",{type:"submit",class:"btn btn-primary btn-lg"},"ask",-1),z={data(){return{item:this.getItems(),questions:[],new_price:0,new_question:"",new_answer:[],question_id:"",file:{}}},methods:{async getItems(){const s=await(await fetch(`http://localhost:8000/bidder/api/item/${this.$route.params.id}`,{method:"GET",credentials:"include",mode:"cors",referrerPolicy:"no-referrer"})).json();this.item=s,console.log(s);const o=Object.values(s.questions);this.questions=o},async bid(){if(this.item.price<this.new_price){const i=new Headers([["X-CSRFToken",m("csrftoken")]]);(await fetch(`http://localhost:8000/bidder/api/item/${this.$route.params.id}`,{method:"PUT",credentials:"include",mode:"cors",referrerPolicy:"no-referrer",headers:i,body:JSON.stringify({price:this.new_price})})).status===200?this.item.price=this.new_price:window.alert("Your bid was not successful")}else window.alert("Your price was lower than the current bid")},async ask(){if(this.new_question!=null){const i=new Headers([["X-CSRFToken",m("csrftoken")]]),s=await fetch(`http://localhost:8000/bidder/api/item/${this.$route.params.id}`,{method:"POST",credentials:"include",mode:"cors",referrerPolicy:"no-referrer",headers:i,body:JSON.stringify({question:this.new_question})});if(s.status===200){const o=await s.json();this.questions.push(o),this.new_question=""}else window.alert("You bid was not successful")}else window.alert("question cannot have an empty body")},async answer(i,s){const o=new Headers([["X-CSRFToken",m("csrftoken")]]),t=await fetch(`http://localhost:8000/bidder/api/item/${this.$route.params.id}/${i}`,{method:"PUT",credentials:"include",mode:"cors",referrerPolicy:"no-referrer",headers:o,body:JSON.stringify({answer:this.new_answer[s]})});console.log(t.status),t.status===200&&(this.questions[s].answer=this.new_answer[s]),t.status===400&&alert("Cannot answer question, You are not the owner of this item")}}},W=p({...z,__name:"index",setup(i){return(s,o)=>(r(),a("div",b,[e("div",y,[e("div",g,[e("picture",v,[e("img",{class:"img-fluid",src:`http://localhost:8000/static/${s.item.image_name}`,alt:"Image depicting the item"},null,8,k)]),e("div",q,[e("div",S,[e("h1",$,n(s.item.title),1),e("p",C,n(s.item.description),1),e("form",{class:"form-outline",onSubmit:o[1]||(o[1]=d((...t)=>s.bid&&s.bid(...t),["prevent"]))},[e("span",null,[_(" Current Bid: "),e("strong",T,n(s.item.price)+"\xA3",1)]),c(e("input",{id:"bid",class:"form-control",style:{"max-width":"200px"},type:"number",min:s.item.price+1,"onUpdate:modelValue":o[0]||(o[0]=t=>s.new_price=t)},null,8,P),[[u,s.new_price]]),e("label",U,"Enter \xA3"+n(s.item.price+1)+" or higher",1),V,j],32)])])])]),B,e("ul",F,[(r(!0),a(w,null,f(s.questions,(t,l)=>(r(),a("li",N,[e("div",O,[e("div",A,n(t.question),1),t.answer!==""&&t.answer!==void 0?(r(),a("div",Q,n(t.answer),1)):(r(),a("div",Y,[e("form",{class:"form-outline",onSubmit:d(h=>s.answer(t.id,l),["prevent"])},[e("div",H,[e("div",I,[c(e("input",{type:"text",class:"form-control",id:t.id,"onUpdate:modelValue":h=>s.new_answer[l]=h},null,8,J),[[u,s.new_answer[l]]]),R]),X])],40,E)]))])]))),256))]),e("form",{class:"form-outline",onSubmit:o[3]||(o[3]=d((...t)=>s.ask&&s.ask(...t),["prevent"]))},[e("div",D,[c(e("input",{type:"text",class:"form-control",id:"askQuestion","onUpdate:modelValue":o[2]||(o[2]=t=>s.new_question=t)},null,512),[[u,s.new_question]]),M]),G,L],32)]))}});export{W as default};
